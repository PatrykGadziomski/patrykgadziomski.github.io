<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Patryk Gadziomski</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
</head>
<body>
    <div class="main-container">
        <div class="info-container matte-display">
            >> Patryk Gadziomski <br>
            >> Information Scientist <br><br>
            >> B.A. Information Science <br><br>
            >> Data Science <br>
            >> Knowledge Management
        </div>
        <div class="graph-container">
            <div id="graph"></div>
        </div>
    </div>

    <script>
        // Data structure
        const data = {
            name: "root",
            value: 100,
            children: [
                {
                    name: "Education",
                    value: 10,
                    children: [
                        { name: "Media University, Stuttgart\nB.A. Information Science", value: 10 }
                    ]
                },
                {
                    name: "Experience",
                    value: 20,
                    children: [
                        { name: "B1", value: 10 },
                        { name: "B2", value: 10 }
                    ]
                },
                {
                    name: "Projects",
                    value: 30,
                    children: [
                        { name: "C1", value: 15 },
                        { name: "C2", value: 15 }
                    ]
                },
                {
                    name: "Skills",
                    value: 40,
                    children: [
                        { name: "Data Science", value: 20, children: [ 
                            { name: "Python", value: 1 },
                            { name: "Matplotlib", value: 1 },
                            { name: "Numpy", value: 1 },
                            { name: "Pandas", value: 1 },
                            { name: "Plotly", value: 1 },
                            { name: "Scikit-Learn", value: 1 },
                            { name: "PyTorch", value: 1 },
                            { name: "R", value: 1 }
                        ]},
                        { name: "Social", value: 1, children: [
                            { name: "Discord", value: 1 },
                            { name: "LinkedIn", value: 1 }
                        ]},
                        { name: "Design", value: 1, children: [
                            { name: "Figma", value: 1 },
                            { name: "Canva", value: 1 }
                        ]},
                        { name: "Game Development", value: 1, children: [
                            { name: "Godot", value: 1 }
                        ]},
                        { name: "Git", value: 1, children: [
                            { name: "Git", value: 1 },
                            { name: "GitHub", value: 1 },
                            { name: "GitLab", value: 1 },
                            { name: "GitHub Pages", value: 1 }
                        ]},
                        { name: "Web Development", value: 1, children: [
                            { name: "JavaScript", value: 1 },
                            { name: "HTML", value: 1 },
                            { name: "CSS", value: 1 },
                            { name: "TailwindCSS", value: 1 }
                        ]},
                        { name: "Databases", value: 1, children: [
                            { name: "MySQL", value: 1 },
                            { name: "SQLite", value: 1 },
                            { name: "MongoDB", value: 1 }
                        ]},
                        { name: "Software I like", value: 1, children: [
                            { name: "Obsidian", value: 1 },
                            { name: "Notion", value: 1 },
                            { name: "VS Code", value: 1 },
                            { name: "Anaconda", value: 1 }
                        ]},
                        { name: "Others", value: 1, children: [
                            { name: "Markdown", value: 1 },
                            { name: "Latex", value: 1 },
                            { name: "Hugging Face", value: 1 },
                            { name: "Docker", value: 1 }
                        ]},
                    ]
                },
            ]
        };

        // Set dimensions
        const width = 700;
        const height = width;

        // Create the color scale
        const color = d3.scaleLinear()
            .domain([0, 5])
            .range(["hsl(152,80%,80%)", "hsl(228,30%,40%)"])
            .interpolate(d3.interpolateHcl);

        // Create the pack layout
        const pack = data => d3.pack()
            .size([width, height])
            .padding(5)
            (d3.hierarchy(data)
                .sum(d => d.value)
                .sort((a, b) => b.value - a.value));

        const root = pack(data);
        let focus = root;
        let view;

        // Create the SVG container - Changed selector to #graph
        const svg = d3.select("#graph")
            .append("svg")
            .attr("viewBox", `-${width / 1.25} -${height / 2.25} ${width} ${height}`)
            .style("display", "block")
            .style("margin", "0")
            .style("width", "100%")
            .style("height", "100%")
            .style("cursor", "pointer")
            .on("click", (event) => zoom(event, root));

        // In the node creation, remove the stroke:
        const node = svg.append("g")
            .selectAll("circle")
            .data(root.descendants().slice(1))
            .join("circle")
            .attr("fill", d => d.children ? color(d.depth) : "white")
            .attr("pointer-events", d => !d.children ? "none" : null)
            .attr("stroke", "none") // Remove borders
            .on("mouseover", function() { 
                d3.select(this)
                    .attr("fill", "#999")
                    .attr("stroke", "none"); // Ensure no stroke on hover
            })
            .on("mouseout", function(event, d) { 
                d3.select(this)
                    .attr("fill", d.children ? color(d.depth) : "white")
                    .attr("stroke", "none"); // Ensure no stroke on mouseout
            })
            .on("click", (event, d) => {
                if (focus !== d) {
                    zoom(event, d);
                    event.stopPropagation();
                }
            });

        const label = svg.append("g")
            .style("font", "10px sans-serif")
            .attr("pointer-events", "none")
            .attr("text-anchor", "middle")
            .selectAll("text")
            .data(root.descendants())
            .join("text")
            .style("fill-opacity", d => d.parent === root ? 1 : 0)
            .style("display", d => d.parent === root ? "inline" : "none")
            .each(function(d) {
                const lines = d.data.name.split("\n");
                d3.select(this)
                    .selectAll("tspan")
                    .data(lines)
                    .join("tspan")
                    .attr("x", 0)
                    .attr("dy", (d, i) => i === 0 ? 0 : "1.1em")
                    .text(d => d);
            });

        zoomTo([root.x, root.y, root.r * 2]);

        function zoomTo(v) {
            const k = width / v[2];
            view = v;
            
            // Update the position of the text elements (not tspans)
            label.attr("transform", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);
            
            // Update the node positions
            node.attr("transform", d => `translate(${(d.x - v[0]) * k},${(d.y - v[1]) * k})`);
            node.attr("r", d => d.r * k);
        }

        function zoom(event, d) {
            const focus0 = focus;
            focus = d;

            const transition = svg.transition()
                .duration(750)
                .tween("zoom", d => {
                    const i = d3.interpolateZoom(view, [focus.x, focus.y, focus.r * 2]);
                    return t => zoomTo(i(t));
                });

            label
                .filter(function(d) { return d.parent === focus || this.style.display === "inline"; })
                .transition(transition)
                .style("fill-opacity", d => d.parent === focus ? 1 : 0)
                .on("start", function(d) { if (d.parent === focus) this.style.display = "inline"; })
                .on("end", function(d) { if (d.parent !== focus) this.style.display = "none"; });
        }
    </script>
</body>
</html>